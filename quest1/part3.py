TEST_INPUT = "xBxAAABCDxCC"

INPUT = "DBCDBDBBxDBxxCxBxBBAxBACBCxBxBAxBABCBCDBDBAxDBxxBxBDxxBBCBxxCACBCADACDDCBCBACxBxDxCAxxDxDAAAxBDBAxBABBAxCCABDBxBxxCxBBDxAxBADCAAxDAAAABCDCxxxCBABDCxDDBADCDDCxCABCDBCxBDCBCADxADADDAxBACADxCDCDBCDAACDAxAABBxADCBBADCCDBCAxBDBACCCBxACACCACCDCDAAABBCCABBACBxCABDCBBBDBxCCBAABDDxACAxABCDDBCADCBxDDAABBBAxxBAAxADCBxBBCBDADxxBCADACAxBBAAAADAxxDDxAxxCxDAxDCDABDxACACDCACCAACCxACCDDCxDADxCxCxAxxDCxCDBBBxBDxCABCAxBBDxxxBxCBADBBxACDDBBDxxACADACCBxDAxCCDAxDADxxDCxBxBCxxDxBCABCxBCxDBACxBCDDCxCCxDBABCBACxxCxxABCBBBAACCAxxAxAxDCBCBBAACBACxBCDBDBADDxBAADDAADCxCCxAACCCBDBABABDDACDCBAAAAxxCDAACxADxBCDCCBACAxxBxCDxDABCDBxxxBCxCCDCCBAxBDBDxDBDxCxACCBAxDBBDDBAxCBDBxCCxAxAAxDxxBABBBBxBCCDBAxDCBDACABACCDCDCCxBBAADCDAABDBxCxxDAADACABCDBCCACBDxxDBBBxCBxBBCABCACxxCBDCCAABBCDCCDBCxACADBDBDDAAADBDCBxACxBxABxxCBAxAxxCBxCBCxAxCAxCABCDCCxxDBABxBBDxBxCDxDBBDxDBAABBCxCBCBDCBCABDAAxAAAABAxABBBCACDBBACADxxxACBDxDDBDCDDBBDxDDDBACxDCBCAAxDABAxDACBBxDCDBACCAxAxDAABDxxCDBDDABBBAADAxAADCxCDDxBxBCCACCCABxAxCxxCDABBCBCBCDxCxBCDDxxBCxxxDxDACCxBxDADCBxCADACCxAADxAAxDBCxxxDxxCACDABCDDCxBDxCBABCABCDBBDxCACABACCBDBDDxABxxDCBACDDCxAADDBCCACxBAACBCAxACCCDADDxBCCBDDxCDCDADCxCDAxCCDxCBxABxxxCCCxCADxCBDxCADBBxBBABDDCACDCBBBBDAxDAAACxBBxABxAACCxCBDCAAAxDCDADxxxCDCBAxAxBBCCBCDCDADxACCBCxCBxBxCBACDADxDBBDxxCxDBxxAxBxABxxCCADDCCxDACxxADCDDCADDDDDBCDDBBxxABxDCDAAAxDxxABCDBAAAxBCxADCACDADCCCADCBDAABAxABBxCCDCxDAACDDCxADBxxCAABBDADDAxCCCCxABxAAxBxxCCCxACxCADDDxCBDCxDCCABACBBCxBCDxCxBAxCADCBAAAxDCCCADxCxBCBDBDDDBCBBAxAACAABDxADADADCACAADCAABDBBCDAACDDABCCxxCDABADBACDCDCDBAxBCBxxBxAxCCDCABADACCDADxCCBABCBADDBABDxCABBBADBDCBACBCAxBBADCBABAACCABBxCxxxABBBxxCABxBxDAxDBCDAxxDBDDDBDACxxCADxBAxCBADxBAABxABABCCCABBxxBBADDAxCBxxCCCCBDxCBDDDABBAxDDDAAACBxxDDBBxxxDBCxxxxDDxBxxACACDADCBBxBDxBBDDDADBAxxAABxBxCDCCCCDBBDCDAxAABxCDAAAxCCACCxBxCAAADACAADDCABCAxxCBBxADxCxDxCCBABBAADDCADBxAxCxADBACACAxCxxCxBACCCCxCCBCCDxDCDBABCAAAxxBDCxBACDxBxCCxBBBxABABBAxDDBBCDxACBxADBDAxxxBBCxDAAxxBCAABxxxAxACBACDDCBCCCABDBDDAAABCBBDDDCAxDCACxAxCCCDABxxxBCADCDBBCxCBxBxDBCxABAxxCDABBCxCDABACCDAAxCCxCADADxBxBxDABxBBxxBBDCCCBCDDBCxBAABABBBxDADBDBDABBBAACBDDDCACCAxBACBDBAxABADCCBxAADCDDCBDBDDABADACxCCxBBAxDCDBBxACxCDxABxCDCDBCDBCDAAAAAACBDCABDACAADCCDxBCxBDDCDADCDxBCCDxDxxxDAADDxxDDDBBCxADDCDBBxDACACxDADBCDDDBAADBCxDCxCCxBxxxCBDCBABCCCDAACxBCxBDDBxxCCDxADDCBDDDBBCxDDABBAxBADxDxCCDCBCDCACCBxBAABCBBCBxBCBxDCCDDDxxxDBBDDBCAxABBCBBBxxAxACDDxBAADxxADAxBxABCABCxBxBCCCADCCDBCxCDxAxBABABCBAxCBDDCxADDxDCCBABBCDxBACACDAxDDCBBDxBBDDCACCxBACABCxDCCDBxCCDAxCBxCDCACxAxxCBBxCDCCACBCCxDxBxDxDACDxADDCDBDBBABDBAACACBBxACxAxBxxAxCxBDBBDxCDBCABCxAADBxDACDxBBxACBCAxBxDxBABBDCCACDBCDAADxDBCAxABxAADBCDACABxDxxDDBCBBDDAACDCADCAADCADBDBxxAxBBDBCDDBCCxABACCxBBCDDDAxDAAxxCADACCAxDCDxDAxxAAxACxBxDDxCBDAACBBCCCACxDCCBBDBDxAAAxxABxxCxBABADDACBCCAxCxACACBDCDDxAxAABCACDDABAACDAADxABBABCxDBCBCDCCCDxBxCDxCABCCAxBBxDDABBACxDADCxAADDCDxACCCBCBBCACCCDxCxCADxDxADCxBACBBAACBDxDBCAACBDDBCBBBBBBBDCBCBBACxAACADCxxBxCBxCAxCDxBBACCDBDBBBAADxxBxBxCAAAAxCBxDDCxxBCCCAABBCDxACDxBBxBCxAxxxCCxAxDxBCxADDxADBCBCBCxDCDBACCADCBDAxCBBDCACBxCACBDxDACxxxDCDxCAxCCDxBDBADCCCCDDCBxBxDxACCDCCxADCCxDCCAAADxxCAAAxBACCBCCxDADxCCDxxABAxACxCCAxCxxBCCADDBDBDAxACCCDCxxAACBCxBBCxABCBDAxDCCxACBAxADBBBxAAxBABADCADCBDDDxDCAxCBDDDBxBxxCCACACCACCxDBCxDDAxDCCBBBBDDxDCBABABCBBCCCBBBABBCBBADxAxBxABDBABABCAAxCBBDCxAAADDBADBABBAxBCBAxBxDDxAxAADDBABxAAADBAAxBBCxxAxxABxCDxABxDBBABBCxxCCxACCxBABBxBxDCBCDxBDDDDxDAAxxDxCCBACACACABDxBABCxDxCDBAxBCDADDxBxCABxxDBCCBBDxDBxBDAACCCBDBxxBDDABCxCDxDCDxxBCBDCDxAABDDxCCxBAxACAAxBCxABxCBCBCxBBDDxDADCxCABADBBABxDxDDDxDDxCBDCxBCxABBxxAxDDDxAAxACCDCxxxABAAAxDDCAxDxAAACDCxBBACDBCBAxBxABAxDBBxAAAxxAxxxABCBxxACxBDADxCCDCxABCxBxBBDAxxDBCCCxCDACDADxADDxBxBCBABxxDBDBxDxxAACDCCDBCBCCDAAADDBAxBCxBxDDBABxxDxBxBBCBxBACDBxxCDxADxDAxBDACBAADADBBCDDCCBADxBBxxACBCCAxBCBDAxDCxDAxCxxDDCAACDDBxABCBDxDBAAxDCDBxABBxCxACBBCCCxxAxAAABCxAABCDABxBABDBCxBACDxADBDCDxACCBxBBBCDABDCBDDxAxABCDxCABxCxCCBDxBBDCBBABCCAxDDACCBAABCCBBBBCAxxDxxBxDADBCADxCCCCxxCCDDBCBxCCAACBBDCAACBACxDADBxAADxACDxCxACACCBABCCAACCCDBDDxCBBCCBAxBDBBCBDxCCCDDBCBxADACBBCCAxBxCDBCBAxCDBDBAxDBxDDDABABADABDDCCCCDDACBxxDADACCDxAAxBBBxBxCCCAAAADBxBxCDBCxDxDCCxDxDCBAxBCDCBABADxABBBCADADBCBCADCxDCCCxADAxADBBDBCBBxADDACBDBDCxCCBCACBDCBCCACCBDCxxCCxABBDBBxDBCDBBCCBDCxBBxDxDCDBDABAACCBDADABAxAxxCDCxxDxxBDBDCCCBxxxCADCDxDBCCCCBDxDCABxADACCABCxDxCCxCADDBCBDBCAxCBACBBxDDxBCCBAACxBxCxDDBxCxAAxAxxCBxxBADxDBADCBADDxBDDBDCDxxDAADABxCAAxACBBACxBxCDBDDBDDDxBBCxDDDAxCDDDDDACxCAxDBDCxCCBDDCDCAACCDCAxBBCCACACADBCDBACCDxxDAxCAABBCABxxAADACxxCDBDCxxDxACDDxABCAAAxxAxDDCAxDAxDxCADAACCxBAxxBDDxDxxDBxxCxDCDAAxDCxCACDCDDxABDABxAxDxBBAxAxAAxAxBBAxBACABxxBDDBAAxCABDCCxxCADxAxCxBBACBxCxCxBBCBABxABBAxxACCxxBDDDAACCCBxADCCBCBACCBAADxCCBxxABDCxxACAABABAACCAxADBBBxBCCBxDAABDxCBBAxxBBBBxAAAACBCDBxxCDxxCDxCCBDBBDCBDDCBBDxDBxxxxDDDCCBxCADBBDxBBCBxxCCACxBDCCCACADCDCBxADDBxCDBCBDBCACxBBCBBCDAxxAxxBBBBABCAACABCBADCxxDACDCCCCAxBxCCxDAxACxDDxBBBxCxCxAxAxAACBxBBCBDxCDDxxCCCADACCxAAxBBDCAAAxABDACDAAADDACDAAAAxAxCADCBADBBBBAxAxDxCBxBBCCxAxxAxCxDCDABADCxCCBBCABxCCxDxxDDCBBACxDxxxBxxBBCBBBBCDBxCACBBBxCCBDDBCCxxAxACCxxxDxDABDDBAxxACxCCDxDDxxDCCAxDDAAxDACDCAACABDDCAABCxCDCxCDxABCCDxCDBAADCDCBAADCDADxCDCxBAxxxxCABBCDADABBDACACDxBCAADxCBBCDAxADCCDDCxDxAAACxBABCBADxxCDAxDxBBDDADDABCxDxxDACCABBADCCxCBBDABAxBBDCABDxxDADDxCDCCDADDCDDDxxBAABDDCABCACAACDACBBxBDADDABBBBAxDAABAACBDBxAxDxxCACDABCxBDBBDABABBABBxxxABxBDCCABAxAABxxABCDBBDAACBBAxCBDDBBBDDBBBADBxABDABxxBBCACBxCBDxABxxBCDBDBBCBDCAACxAxBDxDDxACDCCBxAxACACDAAAxAADCADBBBADxAAxCDxxDxCCCCxBBxxABAxAxBCABBDDDDCDxCACCBBADDACDBADxxACABBABABBDBDxCBDDDxDADCDCDDADDDADBDADBBCACCxACBBDBCCABDABADCDBCCBCADCAxxDxBCCxCxBCCCDBCBCBxBxBDAACDDCCCDDCxCDDABxxAxxBCDBAACADCDDDxCBABAxAAxAxxDADCxBBAABxxxDCBCACxDABDDxDDAxCCACCABACxACDxxDxCDCxDABAxCxACCDxAxCCBDCCxDxCxxDADDBDxACADxACBAAxxxCBCDDBxDAxBDxCxAABDCxCDCBDxABCxADCDBCCAxxCxCBBxDCDCBACBDADACBCxADDCAxADADBBCCBxADDCBAxBDBCBBADCCADCADxADADxABxCCBBDDBDCCBBABADADCABAABDBCCAxxAxDCCBDCDBABxBDBxDxDDAxCBCxDDDDCAxAxABBBDCCCCxBCxABDACCCADDDCxBADBABxxADADBxDDBDCxxxxCxDDCxCBxDADCxxCABCDCCxADDBBBCxDAABBABCxCACBBBCCAABCxBBCAAAxBxABADDCxBDxxDxCDAABCCCDDAxADxCxBAxDxDxCBDDADCDDBDDBADxAAxBCDBBxBDCxDCCBDBCBxCBADDBDBCDBAxBADDCBAAxxxADDAxADDABDAxxDBBxCBCxxAABBxBxAxACBDDxBxCCCBBBxxBCADDAxDDCDACxxABBxxCxACCxCxAxxDBCxBxDABCCDAAABAxBCAxBCBADAAxxxDADBBDDDACCxDAAxABACxxCABxDCABCADxBBCADBxDxABADBDxCACxxCBxxxCCCDAxxCDxDxxAxBCBBDxCDxDxDBCCBACxBBDCDACBCBABDxAxCxxxCCDABABDDABAABxBABxDCACBACACCADBBAAxBDDDADDBxDCDDDxABACACxxxBDAAABxxAAADxDDCxDDxABDBBCCABDDxBxBDCBxxDBBDDAxADACABxABDxDxxAxAxABAAADADAxCBCDDAxCBBCCCxCABACDxABACCDABABDBACxCAxCDAACBDCDBBBAxDAAAACAABDDDBDBCBBCDABCxCBBADBCDDBDCxCAACADBBxAABCDxADxBDDxCxCDCBAAAACxDCADDCCxCCBACBxBCCxxAAxBDCxDCADBxCCADCCDBxxxBCADBxBBABCxBDCxCDBxBDxDDACBDCDDBCBDBxAADCDCBCBDADDCDDxCBADBCCDCACxBCBDCCBDCxDCDCBxDACAACADCACBBDABDCDCBAxCCAAxCADxCDBABADBCAxxDBxACCADCBxADDADCCCBBCBBBBABAABxCBCCCBDCxBAxDDxxCDDBxCDxBDDACCADABBBBBDBxxCAxDABCxACCxDBBBCABxDCDAxABDxCAxDDxCBBDDDACBAxAxBxxCAxADCAxBxCCDCAxCCACCDAxCDAACAxADCCAABCCxBCCxABDxxABxADABBxCAxDDCCDCBAAxBDACAxDBCADAABBCDAxCCABABDBCACCDCDCDBACDACACCDxBCDBxCBDxxDDDDxBDBCDBCABDxADACCDxADxABBCDDBxDBBDxCBxCDAADCCABDBADACBAxBDxxBxBACCxxxABDADCDDBDCCBDADCDBAxABBBDBCACADACACCADCAABBxDDDCxBDCCADCBAABxCAABDCxACDAxCCCxAACCBBAAACCAxBBBDAxDAADxCDCAAAxCDxCxCBAABCxDDxBACBDAxAADBBDBACCAACxAADxAABDCCBABxBAABCADxCBxBBDDBDDABAAxABDxxxABDCDBABBCADxACBABBBBxABBCCDxxDDBBCBxBxBAADBACBBCABDADDBBABDxxACDDBBDDxDAAAxxCxAADDAxxADxxxDxDxDBBBDxADDACCCDAADBAADBABCAxCDAABxDxxDBxCDACDDCDBBDBBxCDxABAAxBBxCABxABBCADxCCADxBAAxADCAADCxBCBABBxCABCCBCCCCACDCBCBxDCxAxCABBBxxCCxBBxBxDDDAAxCCBBDDACxDDxxxBACBxABBADxDDCCACAADCxDCDCBCBxBCCxBDAADBBBBDACxxAxBAxADxACxABxDAxACCCCDDCADCxDADBAxDABBBADCxCxCxCBDxABCDDBAABCDCBADxCCxDDAAABCABABDCCCCCADCBDACxCDxCAxDCACAxAxCCDCBAAxDxBCCBBCxBACxCxBBxxBxxBxxABABDBDDDxDBDABACBBDDDxCCxCxBAxDxCBCDxDCAABDDBCDBCxxxABBDxDABAADxxCADDDCxDDCCDAAAAxxABBDCBBCCxDCDBCBCxDxACBxDBxDBCDACAAACDADAAxBCBACBCBABxxBBCCxxADCDCCBBADAxDBCCBBBDxBCCxBAxADDAAxBxCDBDBxBxAxBAABCBDDBBxCxBxBCxxCBxxxDBCAxCxCADAADDDADBCDCBADxBDADxxDxBCAABxAxADACCCDDBAADAxBABADDxCxBBBCBABxCDDBDCxCDCBCDBDxDxACDxDBBBBxBCDxBACDACDDAAxxxBABABAxxBxBBxBADADCBxBDDDBxCDDxBBBBDDBCxxBABBADDCDxAxCDCACAxACCADADCDCxDADADxBADCDBBxACxDBxBBADABDDDDADABDCAxCDDBCxxAxDCAxBxAxBABDBBBCBxDAACDCCABAxDDDADCABCAxACCCDxxAxAxCCBDDCxDAABBCBDCBAACDADCCACDCDCDDxDABBxBDCAxAxBBxAAxCxAABBxAADDCAxAAABBAAAABBCxDxxBxBBCxBxADBxBABABCDxAAAxAACADDAADABDBAxDBADBABCADBBACAxDBABCDAABAxBDCCBDBCDxBADCxBBADBDDBCBDxCBDAAxxxCBDxBADBDxDDAxDCDCDADBCxACBABDBDxxxCCDBAxDDDBDCDBCCBCDDCCxBCxACBACxDCCCACxADACAxBxCBBxxDxxDACADxCABCCDBDDBDCCxxDAADDxxADDAADDDAAxADBBBABDABxCxADxCCAADADAxCBxBCBDxxCDDCxCCACDCCCADBCDDCBADxADDCDADACDBACDCBxBAADDxAxxBxCBAACxCABxBBACxBxCABCCxCxAxACxDDxBBAxxDADCDBCxCDBBBCCDADxxDABCCDxACABxxDCBBBxxCDADBDCxDxCxxxAABxCxDxBxAxxCDBxACDDxDCDBDDCBDBDxDDxADDxAAACADAxxCDxCABxCBxABxDCBBDABAACDCAACDDxDCADABDDCACxCCxBADAADBABAxACxDACACAxDBBABABxBxBDBBBCACBDDxAAACxAACDCADBACxxDCCABCDxxDDBxBCAADCxCBCBDDDDBxBABBxDCABBACAADDBBxAxABBDxBCxBABABACAxBBDBDCBABDCCxBCCDD"

from collections import Counter


POTIONS_PER_CREATURE = {
    "A": 0,
    "B": 1,
    "C": 3,
    "D": 5,
}


def compute_total_potions(input):
    result = 0
    for i in range(0, len(input), 3):
        freqs = Counter([input[i], input[i + 1], input[i + 2]])

        if freqs["x"] == 0:
            result += (
                POTIONS_PER_CREATURE[input[i]]
                + POTIONS_PER_CREATURE[input[i + 1]]
                + POTIONS_PER_CREATURE[input[i + 2]]
                + 6
            )
        elif freqs["x"] == 1:
            val1, val2 = [
                el for el in [input[i], input[i + 1], input[i + 2]] if el != "x"
            ]
            result += POTIONS_PER_CREATURE[val1] + POTIONS_PER_CREATURE[val2] + 2
        elif freqs["x"] == 2:
            val1 = [el for el in [input[i], input[i + 1], input[i + 2]] if el != "x"][0]
            result += POTIONS_PER_CREATURE[val1]

    return result


print(compute_total_potions(TEST_INPUT))

assert compute_total_potions(TEST_INPUT) == 30

print(compute_total_potions(INPUT))
